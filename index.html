<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=32&h=32&fit=crop&crop=center" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="Discover and book amazing kids activities, events, and educational programs in the UAE. Find the perfect activities for your children with Gema Events." />
    <meta name="keywords" content="kids activities, children events, educational programs, family fun, kids entertainment, booking platform, UAE, Dubai" />
    <meta name="author" content="Gema Events" />
    <meta name="robots" content="index, follow" />
    <meta name="language" content="en-US" />
    <meta name="revisit-after" content="7 days" />
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="Gema Events - Kids Activities Platform" />
    <meta property="og:description" content="Discover and book amazing kids activities, events, and educational programs in the UAE." />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://gema-events.com" />
    <meta property="og:image" content="/assets/images/og-default.jpg" />
    <meta property="og:site_name" content="Gema Events" />
    <meta property="og:locale" content="en_US" />

    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Gema Events - Kids Activities Platform" />
    <meta name="twitter:description" content="Discover and book amazing kids activities, events, and educational programs in the UAE." />
    <meta name="twitter:image" content="/assets/images/og-default.jpg" />
    <meta name="twitter:site" content="@gemaevents" />
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#3B82F6" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="apple-mobile-web-app-title" content="Gema Events" />
    <meta name="application-name" content="Gema Events" />
    <meta name="msapplication-TileColor" content="#3B82F6" />
    <meta name="msapplication-config" content="/browserconfig.xml" />
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json" />
    
    <!-- Apple Touch Icons -->
    <link rel="apple-touch-icon" href="/apple-touch-icon.svg" />
    <link rel="mask-icon" href="/icon-192x192.svg" color="#3B82F6" />
    
    <!-- Preconnect to external domains -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Cairo:wght@300;400;500;600;700;800&family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet" />
    
    <!-- Leaflet CSS for maps -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
    
    <title>Gema Events - Discover Amazing Kids Activities & Events in UAE</title>

    <!-- Organization Structured Data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Organization",
      "name": "Gema Events",
      "description": "Discover and book amazing kids activities, events, and educational programs in the UAE",
      "url": "https://gema-events.com",
      "logo": "https://gema-events.com/assets/images/logo.png",
      "contactPoint": {
        "@type": "ContactPoint",
        "contactType": "customer service",
        "email": "info@gema-events.com"
      },
      "sameAs": [
        "https://www.facebook.com/gemaevents",
        "https://www.instagram.com/gemaevents",
        "https://www.twitter.com/gemaevents"
      ],
      "areaServed": {
        "@type": "Country",
        "name": "United Arab Emirates"
      },
      "serviceType": [
        "Event Management",
        "Kids Activities",
        "Educational Programs",
        "Family Entertainment"
      ]
    }
    </script>

    <!-- Critical Polyfills - Must load before any other JavaScript -->
    <script>
      // Ensure console is available for polyfill logging
      if (typeof console === 'undefined') {
        window.console = { log: function() {}, warn: function() {}, error: function() {} };
      }

      // Feature detection and polyfill setup
      window.__POLYFILL_STATUS__ = {
        fetch: typeof fetch !== 'undefined',
        request: typeof Request !== 'undefined',
        response: typeof Response !== 'undefined',
        headers: typeof Headers !== 'undefined'
      };

      console.log('[Polyfills] Initial feature detection:', window.__POLYFILL_STATUS__);

      // Global polyfill fallbacks - ensure these are never undefined
      if (typeof globalThis !== 'undefined') {
        // Provide safe fallbacks to prevent destructuring errors
        if (typeof globalThis.Request === 'undefined') {
          globalThis.Request = function Request(input, init) {
            console.warn('[Polyfill] Request constructor called but not available');
            throw new Error('Request API not available - polyfill loading failed');
          };
        }
        if (typeof globalThis.Response === 'undefined') {
          globalThis.Response = function Response(body, init) {
            console.warn('[Polyfill] Response constructor called but not available');
            throw new Error('Response API not available - polyfill loading failed');
          };
        }
        if (typeof globalThis.Headers === 'undefined') {
          globalThis.Headers = function Headers(init) {
            console.warn('[Polyfill] Headers constructor called but not available');
            throw new Error('Headers API not available - polyfill loading failed');
          };
        }
        if (typeof globalThis.fetch === 'undefined') {
          globalThis.fetch = function fetch(input, init) {
            console.warn('[Polyfill] fetch called but not available');
            throw new Error('Fetch API not available - polyfill loading failed');
          };
        }
      }
    </script>

    <!-- Load fetch polyfill via CDN for maximum compatibility -->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=fetch%2CRequest%2CResponse%2CHeaders" crossorigin="anonymous"></script>

    <!-- Verify polyfills loaded correctly -->
    <script>
      // Update status after polyfill loading
      window.__POLYFILL_STATUS__ = {
        fetch: typeof fetch !== 'undefined',
        request: typeof Request !== 'undefined',
        response: typeof Response !== 'undefined',
        headers: typeof Headers !== 'undefined'
      };

      console.log('[Polyfills] Post-load feature detection:', window.__POLYFILL_STATUS__);

      // Ensure all APIs are available globally
      if (typeof globalThis !== 'undefined') {
        ['fetch', 'Request', 'Response', 'Headers'].forEach(function(api) {
          if (typeof window[api] !== 'undefined' && typeof globalThis[api] === 'undefined') {
            globalThis[api] = window[api];
            console.log('[Polyfills] Set ' + api + ' on globalThis');
          }
        });
      }

      // Final verification
      var missingApis = [];
      if (typeof fetch === 'undefined') missingApis.push('fetch');
      if (typeof Request === 'undefined') missingApis.push('Request');
      if (typeof Response === 'undefined') missingApis.push('Response');
      if (typeof Headers === 'undefined') missingApis.push('Headers');

      if (missingApis.length > 0) {
        console.error('[Polyfills] CRITICAL: Missing APIs after polyfill loading:', missingApis);
      } else {
        console.log('[Polyfills] SUCCESS: All fetch APIs are available');
      }
    </script>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>